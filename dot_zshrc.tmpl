# Path to oh-my-zsh installation
export ZSH="$HOME/.oh-my-zsh"

# oh-my-zsh plugins
# Note: zsh-autosuggestions and zsh-syntax-highlighting need to be installed:
# git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions
# git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting
plugins=(
  git
  zsh-autosuggestions
  zsh-syntax-highlighting
  fzf
)

source $ZSH/oh-my-zsh.sh

# ============================================================================
# Editor and keybindings
# ============================================================================
export EDITOR=vim
bindkey -v  # Vi mode
bindkey '^[[A' up-line-or-search
bindkey '^[[B' down-line-or-search

# ============================================================================
# Path configuration
# ============================================================================
# Mise (version manager) - replaces pyenv, asdf, nvm, etc.
eval "$($HOME/.local/bin/mise activate zsh)"

# Go
export GOPATH="$HOME/go"
export PATH="$PATH:$GOPATH/bin"

# Ruby
export RUBY_CONFIGURE_OPTS="--with-openssl-dir=$(brew --prefix openssl)"

# Local bin
export PATH="$HOME/bin:$PATH"
export PATH="$HOME/.local/bin:$PATH"

# ============================================================================
# Aliases
# ============================================================================
alias vi="vim -p"

# ============================================================================
# Tool integrations
# ============================================================================
# direnv
if command -v direnv >/dev/null 2>&1; then
  eval "$(direnv hook zsh)"
fi

# fzf - fuzzy finder
if command -v fzf >/dev/null 2>&1; then
  # Use fd for fzf if available (faster, respects .gitignore)
  if command -v fd >/dev/null 2>&1; then
    export FZF_DEFAULT_COMMAND='fd --type f --hidden --follow --exclude .git'
    export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
  fi

  # fzf key bindings and completion
  [ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
fi

# Source local customizations
[ -f ~/.zshrc.local ] && source ~/.zshrc.local

# Starship prompt (must be at end of file)
if command -v starship >/dev/null 2>&1; then
  eval "$(starship init zsh)"
fi
