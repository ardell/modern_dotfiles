#!/bin/bash
# This script runs once after chezmoi applies dotfiles for the first time

echo "ðŸ”§ Setting up oh-my-zsh plugins..."

# Install zsh-autosuggestions
if [ ! -d "${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions" ]; then
    if git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions 2>/dev/null; then
        echo "âœ“ Installed zsh-autosuggestions"
    else
        echo "âœ“ zsh-autosuggestions already installed"
    fi
else
    echo "âœ“ zsh-autosuggestions already installed"
fi

# Install zsh-syntax-highlighting
if [ ! -d "${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting" ]; then
    if git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting 2>/dev/null; then
        echo "âœ“ Installed zsh-syntax-highlighting"
    else
        echo "âœ“ zsh-syntax-highlighting already installed"
    fi
else
    echo "âœ“ zsh-syntax-highlighting already installed"
fi

echo ""
echo "ðŸ“ Setting up vim..."

# Install vim-plug
if [ ! -f ~/.vim/autoload/plug.vim ]; then
    curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
        https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
    echo "âœ“ Installed vim-plug"
else
    echo "âœ“ vim-plug already installed"
fi

# Install vim plugins
if [ -f ~/.vim/autoload/plug.vim ]; then
    vim +PlugInstall +qall
    echo "âœ“ Installed vim plugins"
fi

echo ""
echo "ðŸ” Setting up fzf key bindings..."

# Install fzf key bindings if fzf is installed via Homebrew
if command -v brew &> /dev/null && [ -f "$(brew --prefix)/opt/fzf/install" ]; then
    $(brew --prefix)/opt/fzf/install --key-bindings --completion --no-update-rc
    echo "âœ“ Installed fzf key bindings"
else
    echo "âš  fzf not found via Homebrew, skipping key bindings setup"
fi

echo ""
echo "âœ… Setup complete! Run 'exec zsh' to reload your shell."
